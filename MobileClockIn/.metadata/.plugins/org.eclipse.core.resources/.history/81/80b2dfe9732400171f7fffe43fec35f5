package com.gess.base.util;

import java.util.Properties;

import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class MailUtil {

	public static void sendMail(String mailServer,
			String mailPort, 
			String mailDomain, 
			String mailUser, 
			String mailPassword,
			String toMailUser, String subject, String contentText) {
		try {
			MimeMessage message = getMimeMessage(mailServer, mailPort, mailUser, mailPassword);
			message.setFrom(new InternetAddress(formMail(mailUser,mailDomain)));
			message.addRecipient(Message.RecipientType.TO, new InternetAddress(toMailUser));
			message.setSubject(subject, "UTF-8");
//			message.setSentDate(new Date());
			message.setContent(contentText, "text/html; charset=UTF-8");
//			BodyPart messageBodyPart = new MimeBodyPart();
//			messageBodyPart.setContent(contentText, "text/plain; charset=UTF-8");
//
//			MimeMultipart multipart = new MimeMultipart();
//			multipart.addBodyPart(messageBodyPart);
//			message.setContent(multipart);

			Transport.send(message);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	private static String formMail(String mailUser, String mailDomain){
		return mailUser+"@"+mailDomain;
	}
	
	private static MimeMessage getMimeMessage(String mailServer, String mailPort, String mailUser, String mailPassword) {
		Properties props =new Properties(); 
//			System.getProperties();
		props.put("mail.smtp.host", mailServer);
		if(!StringUtil.isStringEmpty(mailPort))
			props.put("mail.smtp.port", mailPort);
		props.put("mail.smtp.user", mailUser);
		props.put("mail.smtp.password", mailPassword);
		Session session = Session.getDefaultInstance(props, null);
		return new MimeMessage(session);
	}
}
